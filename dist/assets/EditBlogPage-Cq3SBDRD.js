import{m as q,j as M,h as k,o as U,c as i,a as v,b as t,d as D,w as F,r as E,k as T,l as b,f as p,e as d,v as f,n as y,u as l,F as L,p as N,i as n}from"./index-B_FBt44k.js";import{S}from"./SideBar-Ce49zaSC.js";import{C as R}from"./CustomEditor-CGAOM7K0.js";import{u as z,r as g}from"./index-DDjTWfF1.js";import{b as P}from"./config-DgFZBOIp.js";import{a as w}from"./index-D8rVyQy1.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const j={id:"main",class:"main"},A={class:"dashboard"},O={class:"row"},H={class:"col-md-12"},G={class:"nav nav-tabs nav-tabs-bordered d-flex"},J={class:"nav-item tab-style"},K={class:"tab-content"},Q={class:"col-md-6"},W={key:0,class:"error-msg"},X={class:"col-md-6"},Y={key:0,class:"error-msg"},Z={class:"col-md-6"},ee={key:0,class:"error-msg"},te={class:"col-md-6"},se={class:"col-md-12"},ae={class:"border rounded"},oe={key:0,class:"error-msg mt-1"},le={class:"modal fade",id:"imageModal",tabindex:"-1","aria-labelledby":"imageModalLabel","aria-hidden":"true"},re={class:"modal-dialog modal-dialog-centered"},ie={class:"modal-content"},de={class:"modal-body p-0"},ne=["src"],ce={key:1,class:"text-center p-5"},he={__name:"EditBlogPage",setup(me){const $=q(),B=N(),_=$.params.id,c=M.useToast(),h=localStorage.getItem("token"),m=k(null),s=k({title:"",category:"",date:"",image:null,description:""}),o=z({title:{required:g},category:{required:g},date:{required:g},description:{required:g}},s),x=a=>{const e=a.target.files[0];s.value.image=e,e&&(m.value=URL.createObjectURL(e))},C=async()=>{try{const e=(await w.get(`http://127.0.0.1:8000/api/single/blog/${_}`,{headers:{Authorization:`Bearer ${h}`}})).data.data;s.value.title=e.title,s.value.category=e.category,s.value.date=e.date,s.value.description=e.description,e.image&&(m.value=`${P}/${e.image}`)}catch(a){c.error("Failed to fetch blog data."),console.error(a)}},V=async()=>{if(o.value.$validate(),!o.value.$error){const a=new FormData;a.append("title",s.value.title),a.append("category",s.value.category),a.append("date",s.value.date),a.append("description",s.value.description),s.value.image&&a.append("image",s.value.image),a.append("_method","PUT");try{(await w.post(`http://127.0.0.1:8000/api/blogs/${_}`,a,{headers:{Authorization:`Bearer ${h}`,"Content-Type":"multipart/form-data"}})).status===200?(c.success("Blog updated successfully!"),B.push("/blog/list")):c.error("Failed to update blog.")}catch(e){if(e.response&&e.response.status===422){const u=e.response.data.errors;for(const r in u)c.error(u[r][0])}else c.error("Server error occurred."),console.error(e)}}},I=()=>{window.bootstrap.Modal.getOrCreateInstance(document.getElementById("imageModal")).show()};return U(()=>{C(),document.getElementById("my-blog").classList.add("nav-active")}),(a,e)=>{const u=E("router-link");return n(),i(L,null,[v(S),t("main",j,[e[14]||(e[14]=D('<div class="pagetitle"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="#">Home</a></li><li class="breadcrumb-item active">Blog</li></ol></div>',1)),t("section",A,[t("div",O,[t("div",H,[t("ul",G,[t("li",J,[v(u,{to:"/blog/list",class:"nav-link font-weight-bold"},{default:F(()=>e[4]||(e[4]=[d("List")])),_:1})]),e[5]||(e[5]=t("li",{class:"nav-item"},[t("a",{href:"#",class:"nav-link active font-weight-bold"},"Edit Blog")],-1))]),t("div",K,[t("form",{onSubmit:T(V,["prevent"]),class:"row g-3"},[t("div",Q,[e[6]||(e[6]=t("label",{class:"form-label"},[d("Title "),t("span",{class:"required-mask"},"*")],-1)),b(t("input",{"onUpdate:modelValue":e[0]||(e[0]=r=>s.value.title=r),type:"text",class:y(["form-control",{"is-invalid":l(o).title.$dirty&&l(o).title.$error}])},null,2),[[f,s.value.title]]),l(o).title.$error?(n(),i("div",W,"Title required")):p("",!0)]),t("div",X,[e[7]||(e[7]=t("label",{class:"form-label"},[d("Category "),t("span",{class:"required-mask"},"*")],-1)),b(t("input",{"onUpdate:modelValue":e[1]||(e[1]=r=>s.value.category=r),type:"text",class:y(["form-control",{"is-invalid":l(o).category.$dirty&&l(o).category.$error}])},null,2),[[f,s.value.category]]),l(o).category.$error?(n(),i("div",Y,"Category required")):p("",!0)]),t("div",Z,[e[8]||(e[8]=t("label",{class:"form-label"},[d("Date "),t("span",{class:"required-mask"},"*")],-1)),b(t("input",{"onUpdate:modelValue":e[2]||(e[2]=r=>s.value.date=r),type:"date",class:y(["form-control",{"is-invalid":l(o).date.$dirty&&l(o).date.$error}])},null,2),[[f,s.value.date]]),l(o).date.$error?(n(),i("span",ee,"Date required")):p("",!0)]),t("div",te,[t("label",{class:"form-label"},[e[10]||(e[10]=d("Change Image ")),t("a",{href:"#",class:"text-danger ai-button","data-bs-toggle":"modal","data-bs-target":"#aiModal",onClick:I},e[9]||(e[9]=[t("i",{class:"bi bi-image"},null,-1),d(" View Image ")]))]),t("input",{type:"file",onChange:x,class:"form-control"},null,32)]),t("div",se,[e[11]||(e[11]=t("label",{class:"form-label"},[d("Description "),t("span",{class:"required-mask"},"*")],-1)),t("div",ae,[v(R,{modelValue:s.value.description,"onUpdate:modelValue":e[3]||(e[3]=r=>s.value.description=r)},null,8,["modelValue"])]),l(o).description.$error?(n(),i("div",oe,"Description required")):p("",!0)]),e[12]||(e[12]=t("div",{class:"col-md-2"},[t("label",{class:"form-label"},"Â "),t("button",{type:"submit",class:"btn btn-primary"},"Update Blog")],-1))],32)])])])]),t("div",le,[t("div",re,[t("div",ie,[t("div",de,[m.value?(n(),i("img",{key:0,src:m.value,alt:"Preview",class:"img-fluid w-100"},null,8,ne)):(n(),i("div",ce,e[13]||(e[13]=[t("p",{class:"text-muted font-weight-bold"},"No Image Found",-1)])))])])])])])],64)}}};export{he as default};
