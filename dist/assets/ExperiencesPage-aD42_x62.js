import{S as N}from"./SideBar-CoVQvkwt.js";import{_ as T,r as F,u as z}from"./index-BYVp4fHy.js";import{c as i,a as g,b as t,r as I,d as O,p as k,w as U,e as d,f as u,g as a,v as m,q as j,s as K,t as W,F as R,n as J,i as b,l as P,x as Q,o as n,y as V}from"./index-CIbV6caW.js";import{a as C}from"./index-D8rVyQy1.js";import{d as H}from"./vuedraggable.umd-A9et21qD.js";const Y={components:{SideBar:N,draggable:H},setup(){const _=localStorage.getItem("token"),e=J.useToast(),v=b({job_title:"",company_name:"",start_date:"",end_date:"",responsibilities:""}),o=b(!1),S=b(""),A=b(!1),f=b(null),c=b({job_title:"",company_name:"",start_date:"",end_date:"",responsibilities:""}),x=b(!1),y=b([]),w=b(""),s=b("asc"),E=async()=>{try{const l=await C.get("http://127.0.0.1:8000/api/experiences",{headers:{Authorization:`Bearer ${_}`}});if(l.status===200){var r=l.data;y.value=Array.isArray(r.data)?r.data:[r.data],console.log("Experiences:",y.value)}else console.error("Failed to load experiences.")}catch(l){console.error("Error loading experiences:",l)}};P(()=>{E()});const q=Q(()=>({job_title:{required:F},company_name:{required:F},start_date:{required:F},end_date:o.value?{}:{required:F},responsibilities:{required:F}})),h=z(q,v),D=async()=>{if(!await h.value.$validate()){e.error("Please fill out the form correctly.");return}try{const l={...v.value,end_date:o.value?null:v.value.end_date,currentlyWorking:o.value};(await C.post("http://127.0.0.1:8000/api/experiences",l,{headers:{Authorization:`Bearer ${_}`}})).status===201?(e.success("Experience saved!"),E(),L()):e.error("Failed to save experience.")}catch(l){if(l.response&&l.response.status===422){const p=l.response.data.errors;for(const B in p)e.error(p[B][0])}else e.error("Server error occurred."),console.error(l)}},L=()=>{v.value={job_title:"",company_name:"",start_date:"",end_date:"",responsibilities:""},o.value=!1,f.value=null,h.value.$reset()};return{form:v,v$:h,submitForm:D,askAI:async()=>{if(!S.value.trim())return alert("Enter a question");A.value=!0;try{const r=await C.post("https://api.openai.com/v1/chat/completions",{model:"gpt-3.5-turbo",messages:[{role:"system",content:"You are a helpful assistant that writes professional resume responsibilities."},{role:"user",content:S.value}]},{headers:{"Content-Type":"application/json",Authorization:"Bearer undefined"}});v.value.responsibilities=r.data.choices[0].message.content,S.value="",e.success("AI generated responsibility!")}catch{e.error("Failed to get AI response.")}finally{A.value=!1}},isLoading:A,currentlyWorking:o,aiQuestion:S,experiences:y,deleteExperience:async r=>{if(confirm("Are you sure?"))try{(await C.delete(`http://127.0.0.1:8000/api/experiences/${r}`,{headers:{Authorization:`Bearer ${_}`}})).status===200?(e.success("Experience deleted successfully!"),E()):e.error("Failed to delete experience.")}catch(l){l.response&&l.response.status===422?e.error("Validation error occurred."):(e.error("Server error occurred."),console.error(l))}},editExperience:r=>{c.value={...r},x.value=r.currentlyWorking,f.value=r.id,window.bootstrap.Modal.getOrCreateInstance(document.getElementById("editExperienceModal")).show()},editingIndex:f,editForm:c,editCurrentlyWorking:x,updateExperience:async()=>{if(f.value!==null)try{const r={...c.value,end_date:x.value?null:c.value.end_date,currentlyWorking:x.value};(await C.put(`http://127.0.0.1:8000/api/experiences/${f.value}`,r,{headers:{Authorization:`Bearer ${_}`}})).status===200?(e.success("Experience updated successfully!"),E(),window.bootstrap.Modal.getInstance(document.getElementById("editExperienceModal")).hide()):e.error("Failed to update experience.")}catch(r){if(r.response&&r.response.status===422){const l=r.response.data.errors;for(const p in l)e.error(l[p][0])}else r.response&&r.response.status===404?e.error("Experience not found."):(e.error("Server error occurred."),console.error(r))}},sortKey:w,sortOrder:s,sortBy:r=>{w.value===r?s.value=s.value==="asc"?"desc":"asc":(w.value=r,s.value="asc"),y.value.sort((l,p)=>{let B=(l[r]||"").toString().toLowerCase(),M=(p[r]||"").toString().toLowerCase();return B<M?s.value==="asc"?-1:1:B>M?s.value==="asc"?1:-1:0})},onSortEnd:async()=>{try{const r=y.value.map((l,p)=>({...l,sort_order:p+1}));try{(await C.post("http://127.0.0.1:8000/api/update/experience/order",{experiences:r},{headers:{Authorization:`Bearer ${_}`}})).status==200?e.success("Sort order updated successfully!"):e.error("Failed to update sort order.")}catch(l){console.error("Error updating sort order:",l)}e.success("Sort order updated successfully!")}catch(r){e.error("Failed to update sort order."),console.error(r)}}}}},G={id:"main",class:"main"},X={class:"dashboard"},Z={class:"row"},$={class:"col-md-12"},ee={class:"nav nav-tabs nav-tabs-bordered d-flex"},te={class:"nav-item tab-style"},oe={class:"nav-item"},se={class:"nav-item tab-style"},re={class:"nav-item tab-style"},le={class:"nav-item tab-style"},ae={class:"nav-item tab-style"},ne={class:"tab-content"},ie={class:"col-md-4"},de={key:0,class:"text-danger"},ce={class:"col-md-4"},me={key:0,class:"text-danger"},ue={class:"col-md-4"},be={key:0,class:"text-danger"},pe={class:"col-md-4"},ye=["disabled"],ve={class:"form-check mt-2"},fe={key:0,class:"text-danger"},ge={class:"col-md-12"},ke={key:0,class:"text-danger"},_e={class:"modal fade",id:"aiModal",tabindex:"-1","aria-labelledby":"aiModalLabel","aria-hidden":"true"},xe={class:"modal-dialog modal-lg"},we={class:"modal-content"},Ee={class:"modal-body"},Ce={class:"modal-footer"},Se=["disabled"],Fe=["disabled"],Ve={key:0,class:"spinner-border spinner-border-sm",role:"status","aria-hidden":"true"},Ae={key:1},Be={key:2,class:"ms-2"},We={class:"col-md-12 mt-4"},he={class:"table table-bordered table-sm"},Ie=["onClick"],Me=["onClick"],Ue={key:1},je={class:"modal fade",id:"editExperienceModal",tabindex:"-1","aria-labelledby":"editExperienceModalLabel","aria-hidden":"true"},qe={class:"modal-dialog modal-lg"},De={class:"modal-content"},Le={class:"modal-body row g-3"},Ne={class:"col-md-4"},Te={class:"col-md-4"},ze={class:"col-md-4"},Oe={class:"col-md-4"},Ke=["disabled"],Re={class:"form-check mt-2"},Je={class:"col-md-12"};function Pe(_,e,v,o,S,A){var y,w;const f=I("SideBar"),c=I("router-link"),x=I("draggable");return n(),i(R,null,[g(f),t("main",G,[e[54]||(e[54]=O('<div class="pagetitle"><ol class="breadcrumb"><li class="breadcrumb-item active">Home</li><li class="breadcrumb-item"><a href="">My Resume</a></li></ol></div>',1)),t("section",X,[t("div",Z,[t("div",$,[t("ul",ee,[t("li",te,[g(c,{to:"/resume/profile",class:"nav-link font-weight-bold"},{default:k(()=>e[23]||(e[23]=[a("Personal")])),_:1})]),t("li",oe,[g(c,{to:"/resume/experiences",class:"nav-link active font-weight-bold"},{default:k(()=>e[24]||(e[24]=[a("Experience")])),_:1})]),t("li",se,[g(c,{to:"/resume/educations",class:"nav-link font-weight-bold"},{default:k(()=>e[25]||(e[25]=[a("Education")])),_:1})]),t("li",re,[g(c,{to:"/resume/skills",class:"nav-link font-weight-bold"},{default:k(()=>e[26]||(e[26]=[a("Skills")])),_:1})]),t("li",le,[g(c,{to:"/resume/interests",class:"nav-link font-weight-bold"},{default:k(()=>e[27]||(e[27]=[a("Interest")])),_:1})]),t("li",ae,[g(c,{to:"/resume/publications",class:"nav-link font-weight-bold"},{default:k(()=>e[28]||(e[28]=[a("Publications")])),_:1})])]),t("div",ne,[t("form",{onSubmit:e[7]||(e[7]=U((...s)=>o.submitForm&&o.submitForm(...s),["prevent"])),class:"row g-3"},[t("div",ie,[e[29]||(e[29]=t("label",{class:"form-label"},[a("Job Title "),t("span",{class:"required-mask"},"*")],-1)),d(t("input",{"onUpdate:modelValue":e[0]||(e[0]=s=>o.form.job_title=s),type:"text",class:"form-control"},null,512),[[m,o.form.job_title]]),o.v$.job_title.$dirty&&o.v$.job_title.$error?(n(),i("div",de," Job title required ")):u("",!0)]),t("div",ce,[e[30]||(e[30]=t("label",{class:"form-label"},[a("Company Name "),t("span",{class:"required-mask"},"*")],-1)),d(t("input",{"onUpdate:modelValue":e[1]||(e[1]=s=>o.form.company_name=s),type:"text",class:"form-control"},null,512),[[m,o.form.company_name]]),o.v$.company_name.$dirty&&o.v$.company_name.$error?(n(),i("div",me," Company name required ")):u("",!0)]),t("div",ue,[e[31]||(e[31]=t("label",{class:"form-label"},[a("Start Date "),t("span",{class:"required-mask"},"*")],-1)),d(t("input",{"onUpdate:modelValue":e[2]||(e[2]=s=>o.form.start_date=s),type:"date",class:"form-control"},null,512),[[m,o.form.start_date]]),o.v$.start_date.$dirty&&o.v$.start_date.$error?(n(),i("div",be," Start date required ")):u("",!0)]),t("div",pe,[e[33]||(e[33]=t("label",{class:"form-label"},[a("End Date "),t("span",{class:"required-mask"},"*")],-1)),d(t("input",{"onUpdate:modelValue":e[3]||(e[3]=s=>o.form.end_date=s),type:"date",class:"form-control",disabled:o.currentlyWorking},null,8,ye),[[m,o.form.end_date]]),t("div",ve,[d(t("input",{class:"form-check-input",type:"checkbox",id:"currentlyWorking","onUpdate:modelValue":e[4]||(e[4]=s=>o.currentlyWorking=s),onChange:e[5]||(e[5]=s=>o.form.end_date=o.currentlyWorking?"":o.form.end_date)},null,544),[[j,o.currentlyWorking]]),e[32]||(e[32]=t("label",{class:"form-check-label",for:"currentlyWorking"},[t("small",null,"Currently Working")],-1))]),(y=o.v$.end_date)!=null&&y.$dirty&&((w=o.v$.end_date)!=null&&w.$error)?(n(),i("div",fe," End date required ")):u("",!0)]),e[35]||(e[35]=t("div",{class:"col-md-12"},[t("a",{class:"btn btn-danger","data-bs-toggle":"modal","data-bs-target":"#aiModal"},[t("i",{class:"bi bi-cpu"}),a(" Ask AI for Assistance ")])],-1)),t("div",ge,[e[34]||(e[34]=t("label",{class:"form-label"},[a("Responsibilities "),t("span",{class:"required-mask"},"*")],-1)),d(t("textarea",{"onUpdate:modelValue":e[6]||(e[6]=s=>o.form.responsibilities=s),class:"form-control",rows:"5",placeholder:"Describe your responsibilities..."},null,512),[[m,o.form.responsibilities]]),o.v$.responsibilities.$dirty&&o.v$.responsibilities.$error?(n(),i("div",ke," Responsibilities required ")):u("",!0)]),e[36]||(e[36]=t("div",{class:"col-md-4"},[t("button",{type:"submit",class:"btn btn-primary"},"Submit")],-1))],32),t("div",_e,[t("div",xe,[t("div",we,[e[38]||(e[38]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"aiModalLabel"},"AI Assistance"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Ee,[e[37]||(e[37]=t("p",null,"How can I help you? Ask me anything related to your responsibilities.",-1)),d(t("textarea",{"onUpdate:modelValue":e[8]||(e[8]=s=>o.aiQuestion=s),class:"form-control",rows:"4",placeholder:"Type your question..."},null,512),[[m,o.aiQuestion]])]),t("div",Ce,[t("button",{class:"btn btn-secondary","data-bs-dismiss":"modal",disabled:o.isLoading}," Close ",8,Se),t("button",{class:"btn btn-primary",onClick:e[9]||(e[9]=(...s)=>o.askAI&&o.askAI(...s)),disabled:o.isLoading},[o.isLoading?(n(),i("span",Ve)):u("",!0),o.isLoading?(n(),i("span",Be,"Waiting...")):(n(),i("span",Ae,"Ask"))],8,Fe)])])])]),t("div",We,[t("table",he,[t("thead",null,[t("tr",null,[t("th",{onClick:e[10]||(e[10]=s=>o.sortBy("job_title")),style:{cursor:"pointer"}},[e[39]||(e[39]=a(" Job Title ")),o.sortKey==="job_title"?(n(),i("i",{key:0,class:W(o.sortOrder==="asc"?"bi bi-arrow-up":"bi bi-arrow-down")},null,2)):u("",!0)]),t("th",{onClick:e[11]||(e[11]=s=>o.sortBy("company_name")),style:{cursor:"pointer"}},[e[40]||(e[40]=a(" Company Name ")),o.sortKey==="company_name"?(n(),i("i",{key:0,class:W(o.sortOrder==="asc"?"bi bi-arrow-up":"bi bi-arrow-down")},null,2)):u("",!0)]),t("th",{onClick:e[12]||(e[12]=s=>o.sortBy("start_date")),style:{cursor:"pointer"}},[e[41]||(e[41]=a(" Start Date ")),o.sortKey==="start_date"?(n(),i("i",{key:0,class:W(o.sortOrder==="asc"?"bi bi-arrow-up":"bi bi-arrow-down")},null,2)):u("",!0)]),t("th",{onClick:e[13]||(e[13]=s=>o.sortBy("end_date")),style:{cursor:"pointer"}},[e[42]||(e[42]=a(" End Date ")),o.sortKey==="end_date"?(n(),i("i",{key:0,class:W(o.sortOrder==="asc"?"bi bi-arrow-up":"bi bi-arrow-down")},null,2)):u("",!0)]),e[43]||(e[43]=t("th",null,"Responsibilities",-1)),e[44]||(e[44]=t("th",null,"Actions",-1))])]),o.experiences&&o.experiences.length>0?(n(),K(x,{key:0,modelValue:o.experiences,"onUpdate:modelValue":e[14]||(e[14]=s=>o.experiences=s),tag:"tbody","item-key":"id",onEnd:o.onSortEnd},{item:k(({element:s})=>[t("tr",null,[t("td",null,V(s.job_title),1),t("td",null,V(s.company_name),1),t("td",null,V(new Date(s.start_date).toLocaleDateString()),1),t("td",null,V(s.end_date==null?"Currently Working":new Date(s.end_date).toLocaleDateString()),1),t("td",null,V(s.responsibilities),1),t("td",null,[t("button",{class:"btn btn-sm btn-info me-1 text-white",onClick:E=>o.editExperience(s)}," Edit ",8,Ie),t("button",{class:"btn btn-sm btn-danger",onClick:E=>o.deleteExperience(s.id)}," Delete ",8,Me)])])]),_:1},8,["modelValue","onEnd"])):(n(),i("tbody",Ue,e[45]||(e[45]=[t("tr",null,[t("td",{colspan:"6"},"Loading...")],-1)])))])]),t("div",je,[t("div",qe,[t("div",De,[t("form",{onSubmit:e[22]||(e[22]=U((...s)=>o.updateExperience&&o.updateExperience(...s),["prevent"]))},[e[52]||(e[52]=t("div",{class:"modal-header"},[t("h5",{class:"modal-title",id:"editExperienceModalLabel"},"Edit Experience"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),t("div",Le,[t("div",Ne,[e[46]||(e[46]=t("label",{class:"form-label"},"Job Title",-1)),d(t("input",{"onUpdate:modelValue":e[15]||(e[15]=s=>o.editForm.job_title=s),type:"text",class:"form-control"},null,512),[[m,o.editForm.job_title]])]),t("div",Te,[e[47]||(e[47]=t("label",{class:"form-label"},"Company Name",-1)),d(t("input",{"onUpdate:modelValue":e[16]||(e[16]=s=>o.editForm.company_name=s),type:"text",class:"form-control"},null,512),[[m,o.editForm.company_name]])]),t("div",ze,[e[48]||(e[48]=t("label",{class:"form-label"},"Start Date",-1)),d(t("input",{"onUpdate:modelValue":e[17]||(e[17]=s=>o.editForm.start_date=s),type:"date",class:"form-control"},null,512),[[m,o.editForm.start_date]])]),t("div",Oe,[e[50]||(e[50]=t("label",{class:"form-label"},"End Date",-1)),d(t("input",{"onUpdate:modelValue":e[18]||(e[18]=s=>o.editForm.end_date=s),type:"date",class:"form-control",disabled:o.editCurrentlyWorking},null,8,Ke),[[m,o.editForm.end_date]]),t("div",Re,[d(t("input",{class:"form-check-input",type:"checkbox",id:"editCurrentlyWorking","onUpdate:modelValue":e[19]||(e[19]=s=>o.editCurrentlyWorking=s),onChange:e[20]||(e[20]=s=>o.editForm.end_date=o.editCurrentlyWorking?"":o.editForm.end_date)},null,544),[[j,o.editCurrentlyWorking]]),e[49]||(e[49]=t("label",{class:"form-check-label",for:"editCurrentlyWorking"},[t("small",null,"Currently Working")],-1))])]),t("div",Je,[e[51]||(e[51]=t("label",{class:"form-label"},"Responsibilities",-1)),d(t("textarea",{"onUpdate:modelValue":e[21]||(e[21]=s=>o.editForm.responsibilities=s),class:"form-control",rows:"5"},null,512),[[m,o.editForm.responsibilities]])])]),e[53]||(e[53]=t("div",{class:"modal-footer"},[t("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"}," Cancel "),t("button",{type:"submit",class:"btn btn-primary"},"Update")],-1))],32)])])])])])])])])],64)}const rt=T(Y,[["render",Pe]]);export{rt as default};
