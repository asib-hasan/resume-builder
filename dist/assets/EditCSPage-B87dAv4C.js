import{m as S,j as q,h as k,o as B,c as i,a as g,b as t,d as F,w as M,r as U,k as E,l as y,f as p,e as d,v as b,n as f,u as r,F as T,p as L,i as n}from"./index-mpPEvR65.js";import{S as N}from"./SideBar-COT6sxyv.js";import{C as R}from"./CustomEditor-B5OINab7.js";import{u as z,r as v}from"./index-C3a4g50J.js";import{b as P}from"./config-CoiaJPR4.js";import{a as w}from"./index-D8rVyQy1.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const j={id:"main",class:"main"},A={class:"dashboard"},O={class:"row"},H={class:"col-md-12"},G={class:"nav nav-tabs nav-tabs-bordered d-flex"},J={class:"nav-item tab-style"},K={class:"tab-content"},Q={class:"col-md-6"},W={key:0,class:"error-msg"},X={class:"col-md-6"},Y={key:0,class:"error-msg"},Z={class:"col-md-6"},ee={key:0,class:"error-msg"},te={class:"col-md-6"},se={class:"col-md-12"},ae={class:"border rounded"},oe={key:0,class:"error-msg mt-1"},re={class:"modal fade",id:"imageModal",tabindex:"-1","aria-labelledby":"imageModalLabel","aria-hidden":"true"},le={class:"modal-dialog modal-dialog-centered"},ie={class:"modal-content"},de={class:"modal-body p-0"},ne=["src"],ce={key:1,class:"text-center p-5"},he={__name:"EditCSPage",setup(ue){const $=S(),C=L(),_=$.params.id,c=q.useToast(),h=localStorage.getItem("token"),u=k(null),s=k({title:"",category:"",date:"",image:null,description:""}),o=z({title:{required:v},category:{required:v},date:{required:v},description:{required:v}},s),x=a=>{const e=a.target.files[0];s.value.image=e,e&&(u.value=URL.createObjectURL(e))},V=async()=>{try{const e=(await w.get(`http://127.0.0.1:8000/api/single/cs/${_}`,{headers:{Authorization:`Bearer ${h}`}})).data.data;s.value.title=e.title,s.value.category=e.category,s.value.date=e.date,s.value.description=e.description,e.image&&(u.value=`${P}/${e.image}`)}catch(a){c.error("Failed to fetch case study data."),console.error(a)}},D=async()=>{if(o.value.$validate(),!o.value.$error){const a=new FormData;a.append("title",s.value.title),a.append("category",s.value.category),a.append("date",s.value.date),a.append("description",s.value.description),s.value.image&&a.append("image",s.value.image),console.log("Form Data:",a),a.append("_method","PUT");try{(await w.post(`http://127.0.0.1:8000/api/cs/${_}`,a,{headers:{Authorization:`Bearer ${h}`,"Content-Type":"multipart/form-data"}})).status===200?(c.success("Case Study updated successfully!"),C.push("/case/study/list")):c.error("Failed to update case study.")}catch(e){if(e.response&&e.response.status===422){const m=e.response.data.errors;for(const l in m)c.error(m[l][0])}else c.error("Server error occurred."),console.error(e)}}},I=()=>{window.bootstrap.Modal.getOrCreateInstance(document.getElementById("imageModal")).show()};return B(()=>{V(),document.getElementById("case-study").classList.add("nav-active")}),(a,e)=>{const m=U("router-link");return n(),i(T,null,[g(N),t("main",j,[e[14]||(e[14]=F('<div class="pagetitle"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="#">Home</a></li><li class="breadcrumb-item active">Case Study</li></ol></div>',1)),t("section",A,[t("div",O,[t("div",H,[t("ul",G,[t("li",J,[g(m,{to:"/case/study/list",class:"nav-link font-weight-bold"},{default:M(()=>e[4]||(e[4]=[d("List")])),_:1})]),e[5]||(e[5]=t("li",{class:"nav-item"},[t("a",{href:"#",class:"nav-link active font-weight-bold"},"Edit Case Study")],-1))]),t("div",K,[t("form",{onSubmit:E(D,["prevent"]),class:"row g-3"},[t("div",Q,[e[6]||(e[6]=t("label",{class:"form-label"},[d("Title "),t("span",{class:"required-mask"},"*")],-1)),y(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>s.value.title=l),type:"text",class:f(["form-control",{"is-invalid":r(o).title.$dirty&&r(o).title.$error}])},null,2),[[b,s.value.title]]),r(o).title.$error?(n(),i("div",W,"Title required")):p("",!0)]),t("div",X,[e[7]||(e[7]=t("label",{class:"form-label"},[d("Category "),t("span",{class:"required-mask"},"*")],-1)),y(t("input",{"onUpdate:modelValue":e[1]||(e[1]=l=>s.value.category=l),type:"text",class:f(["form-control",{"is-invalid":r(o).category.$dirty&&r(o).category.$error}])},null,2),[[b,s.value.category]]),r(o).category.$error?(n(),i("div",Y,"Category required")):p("",!0)]),t("div",Z,[e[8]||(e[8]=t("label",{class:"form-label"},[d("Date "),t("span",{class:"required-mask"},"*")],-1)),y(t("input",{"onUpdate:modelValue":e[2]||(e[2]=l=>s.value.date=l),type:"date",class:f(["form-control",{"is-invalid":r(o).date.$dirty&&r(o).date.$error}])},null,2),[[b,s.value.date]]),r(o).date.$error?(n(),i("span",ee,"Date required")):p("",!0)]),t("div",te,[t("label",{class:"form-label"},[e[10]||(e[10]=d("Change Image ")),t("a",{href:"#",class:"text-danger ai-button","data-bs-toggle":"modal","data-bs-target":"#aiModal",onClick:I},e[9]||(e[9]=[t("i",{class:"bi bi-image"},null,-1),d(" View Image ")]))]),t("input",{type:"file",onChange:x,class:"form-control"},null,32)]),t("div",se,[e[11]||(e[11]=t("label",{class:"form-label"},[d("Description "),t("span",{class:"required-mask"},"*")],-1)),t("div",ae,[g(R,{modelValue:s.value.description,"onUpdate:modelValue":e[3]||(e[3]=l=>s.value.description=l)},null,8,["modelValue"])]),r(o).description.$error?(n(),i("div",oe,"Description required")):p("",!0)]),e[12]||(e[12]=t("div",{class:"col-md-2"},[t("label",{class:"form-label"},"Â "),t("button",{type:"submit",class:"btn btn-primary"},"Update Blog")],-1))],32)])])])]),t("div",re,[t("div",le,[t("div",ie,[t("div",de,[u.value?(n(),i("img",{key:0,src:u.value,alt:"Preview",class:"img-fluid w-100"},null,8,ne)):(n(),i("div",ce,e[13]||(e[13]=[t("p",{class:"text-muted font-weight-bold"},"No Image Found",-1)])))])])])])])],64)}}};export{he as default};
